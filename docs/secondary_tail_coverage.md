# Статус покрытия проверок

Документ фиксирует текущие области, которые уже покрыты профилями, и отмечает направления для доработки. Список синхронизируется с базовыми тестами (`tests/test_profiles.py`) и служит контрольным списком при добавлении новых проверок.

## Аутентификация и управление доступом

- Пустые пароли и корректные shell системных аккаунтов контролируются правилами `base_shadow_no_empty_passwords` и `base_system_accounts_shells`.【F:profiles/base/linux.yml†L1-L34】
- Sudo проверяется на отсутствие `NOPASSWD`, наличие `requiretty`, журналирования и настройки `logfile`.【F:profiles/base/linux.yml†L36-L82】
- PAM-профиль требует `faillock`, `pam_pwquality`, контроль длины паролей, `difok` и кредитов символов, а также дополнительные параметры сложности.【F:profiles/base/linux.yml†L84-L164】

## Журналирование и синхронизация времени

- Проверки для `chronyd` контролируют активность службы, надёжность источников, наличие `makestep` и минимального числа серверов времени. Эти проверки имеют регрессионные тесты на шаблоны выводов.【F:profiles/base/linux.yml†L331-L409】【F:tests/test_profiles.py†L1-L60】
- Настройки `systemd-journald`, `auditd` и сохранения логов покрыты базовыми правилами, требующими persistent storage и лимитов на объём, а также контроля критичных событий. Дополнительно контролируется синхронизация времени и `fail2ban` для блокировки атак перебора.【F:profiles/base/linux.yml†L500-L585】【F:profiles/base/linux.yml†L1061-L1089】

## Файловая система и права

- Требования к монтированию `/tmp`, `/var/tmp`, `/home` с флагами `nodev`, `nosuid`, `noexec` реализованы и проверяются тестами на регулярные выражения. Также отслеживается deny-list для SUID/SGID и world-writable директорий без sticky-бита.【F:profiles/base/linux.yml†L675-L747】【F:tests/test_profiles.py†L62-L120】
- Проверки целостности загрузочного процесса и конфигурации ядра охватывают secure boot, параметры ядра и запрещённые модули (`blacklist`).【F:profiles/base/linux.yml†L425-L498】

## Сеть и сервисы

- Категория `network` включает требования к iptables/nftables, управлению IPv6, опросу открытых портов и контролю вспомогательных служб (CUPS, Avahi, bluetooth, SSH-agent).【F:profiles/base/linux.yml†L749-L824】【F:profiles/base/linux.yml†L1091-L1104】
- Для `fail2ban` предусмотрены проверки активности и наличия хотя бы одного jail, что обеспечивает базовую защиту от брутфорса.【F:profiles/base/linux.yml†L1061-L1089】

## Репозитории и пакеты

- Для APT и RPM проверяется включённая верификация подписей (`Signed-By`, `gpgcheck`) и отсутствие доверенных репозиториев без проверки подписи. Дополнительно фиксированы минимальные версии ключевых пакетов (ядро, sudo, openssh).【F:profiles/base/linux.yml†L845-L964】

## Автоматические тесты

- `tests/test_profiles.py` проверяет уникальность идентификаторов проверок после наследования и конкретные шаблоны для ключевых правил (ntp, pam, монтирование временных каталогов, sudo).【F:tests/test_profiles.py†L1-L120】
- Workflow `workflows/ci.yml` запускает `pytest`, `flake8`, `mypy` и `yamllint`, гарантируя, что изменения профилей и кода проходят автоматическую проверку перед слиянием.【F:workflows/ci.yml†L1-L58】

## Зоны роста

- Для рабочих станций требуется усилить контроль GUI (GDM/LightDM, политики браузеров) и устройств USB.
- Необходимо добавить проверки для Docker/Podman, а также профили виртуализации (libvirt, KVM).
- Требуется расширить секцию remediation в профилях, чтобы HTML/Markdown отчёты предоставляли готовые шаги исправления.

Документ обновляется по мере пополнения профилей и тестов. При добавлении новой области не забудьте указать ссылку на конкретные правила и тесты.
