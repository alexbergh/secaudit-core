# Дорожная карта развития профилей и движка

Документ описывает стратегию развития SecAudit-core. Список разбит на горизонты и связывает будущие улучшения с текущими возможностями профилей и движка.

## 1. Горизонт «Сейчас» (1–2 спринта)

### 1.1. Расширение покрытия базовых профилей

- **PAM и аутентификация.** Дополнить `profiles/base/linux.yml` проверками на использование `pam_faillock.so` в `auth` и `account` секциях всех интерактивных сервисов и контролировать параметры `unlock_time`, `audit` и `silent`.
- **Журналирование.** Повысить строгость правил для `systemd-journald` и `auditd`: проверять не только наличие директорий хранения, но и объём логов, лимиты скорости, настройки `ForwardToSyslog`.
- **Контроль модулей ядра.** Внести deny-list критичных модулей (`cramfs`, `squashfs`, беспроводные адаптеры) в общий include, а также добавить проверку `kernel.modules_disabled` после инициализации.
- **Файловые системы.** Расширить правила монтирования для `/var/log`, `/var/log/audit` и user-mountable файловых систем (`/srv`, `/var/lib/docker`).

### 1.2. Улучшения движка

- **Локальный кэш фактов.** В `modules/audit_runner.py` уже предусмотрен словарь `command_cache`; необходимо подключить его при выполнении повторяющихся команд (`ss -tulpen`, `systemctl list-unit-files`).
- **Таймауты и обработка ошибок.** Добавить в отчёт поле с длительностью выполнения и пометкой `timed_out`, чтобы операторы быстрее выявляли проблемные проверки.
- **Валидация переменных.** Расширить схему профиля (`seclib/validator`) ограничениями на формат переменных (например, `PWQUALITY_MINLEN_PATTERN`).

### 1.3. Документация и UX

- Подготовить примеры интеграции с системами конфигураций (Ansible, SaltStack) — минимальные плейбуки, которые используют результат аудита.
- Добавить раздел «Remediation» в отчёт (HTML/Markdown) с краткими шагами исправления, если поле присутствует в профиле.

## 2. Горизонт «Скоро» (квартал)

### 2.1. Ролевые и отраслевые профили

- **Рабочие станции.** В `profiles/base/workstation.yml` усилить требования к среде рабочего стола: запрет автологина, политики браузеров, контроль USB.
- **Серверы БД.** Для `profiles/roles/db.yml` добавить проверки на безопасные настройки PostgreSQL/MySQL: `log_statement`, `pg_hba.conf`, шифрование соединений, политики резервного копирования.
- **СЗИ.** Расширить `profiles/szi/snlsp.yml` статусом служб, политиками устройств и валидаторами лицензий.

### 2.2. Контейнеры и виртуализация

- Добавить модуль `containers` с проверками Docker/Podman: запрет `--privileged`, наличие профилей seccomp/AppArmor, запрет запуска контейнеров от root.
- Для сред виртуализации (libvirt/KVM) внедрить проверки целостности образов, ограничений доступа к сокетам управления и применение AppArmor/SELinux профилей.

### 2.3. Отчётность и интеграция

- Сгенерировать дополнительные экспорты (SARIF, JUnit) на основе данных из `modules/report_generator.py`.
- Подготовить GitHub Actions/ GitLab CI примеры, выполняющие аудит golden-образов и сохраняющие отчёты как артефакты.

## 3. Горизонт «Дальше» (полугодие)

### 3.1. Расширяемость профилей

- Реализовать поддержку «наследуемых» allowlist/denylist с приоритетами, чтобы роли могли добавлять или исключать пути без копирования списков.
- Добавить возможность условной генерации проверок из шаблонов (например, формировать проверку для каждого сервиса из списка).

### 3.2. Аналитика результатов

- Добавить модуль «трендов»: сравнивать два отчёта (`results/report.json`) и выводить разницу по статусам.
- Интегрировать экспорт отчётов в Prometheus (метрики статусов) или Elastic (JSON-интеграция).

### 3.3. Автоматическое исправление

- Связать результат аудита с Ansible-модулями: формировать playbook из секции `remediation` и опционально запускать исправление после подтверждения.
- Разработать CLI-команду `generate-remediation`, которая создаёт чек-лист по найденным `FAIL`.

---

План обновляется по мере реализации задач. При добавлении новых проверок или модулей обновляйте соответствующие разделы и ссылку на актуальные профили.
