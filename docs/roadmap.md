# Дорожная карта и статус покрытия

Документ объединяет текущий статус покрытых областей и планы развития SecAudit-core. Используйте его как контрольный список при добавлении новых проверок и приоритезации задач на ближайшие спринты.

## 1. Текущее покрытие проверок

### 1.1. Аутентификация и управление доступом
- Блок `base_shadow_no_empty_passwords` контролирует пустые пароли, а `base_system_accounts_shells` проверяет корректные shell системных аккаунтов.
- Правила для `sudo` исключают `NOPASSWD`, требуют `requiretty`, журналирование и настройку `logfile`.
- PAM-профиль фиксирует использование `pam_faillock`, `pam_pwquality`, ограничение длины пароля, `difok` и кредиты символов.

### 1.2. Журналирование и синхронизация времени
- Проверки `chronyd` контролируют активность службы, надёжность источников, наличие `makestep` и требуемого числа серверов времени.
- Настройки `systemd-journald`, `auditd`, ротации логов и наличие `fail2ban` покрыты профилями и тестами на шаблоны вывода.

### 1.3. Файловая система и права
- Требования к монтированию `/tmp`, `/var/tmp`, `/home` с флагами `nodev`, `nosuid`, `noexec` сопровождаются регрессионными тестами на регулярные выражения.
- Проверяется deny-list для SUID/SGID и world-writable директорий без sticky-бита.
- Контроль целостности загрузочного процесса и конфигурации ядра включает secure boot, параметры ядра и запрещённые модули.

### 1.4. Сеть и сервисы
- Категория `network` охватывает iptables/nftables, управление IPv6, опрос открытых портов, контроль вспомогательных служб (CUPS, Avahi, bluetooth, SSH-agent).
- Для `fail2ban` предусмотрены проверки активности и наличия хотя бы одного jail.

### 1.5. Репозитории и пакеты
- Для APT и RPM проверяется включённая верификация подписей (`Signed-By`, `gpgcheck`) и отсутствие доверенных репозиториев без проверки подписи.
- Фиксированы минимальные версии ключевых пакетов (ядро, sudo, openssh).

### 1.6. Автоматические тесты
- `tests/test_profiles.py` проверяет уникальность идентификаторов после наследования и конкретные шаблоны для ключевых правил (ntp, pam, монтирование временных каталогов, sudo).
- Workflow `workflows/ci.yml` запускает `pytest`, `flake8`, `mypy` и `yamllint`, гарантируя, что изменения профилей и кода проходят автоматическую проверку перед слиянием.

## 2. Фокус ближайших итераций

### 2.1. Горизонт «Сейчас» (1–2 спринта)
- **Покрытие профилей.** Дополнить `profiles/base/linux.yml` проверками для `pam_faillock`, параметров `auditd`, deny-list модулей ядра, расширить правила монтирования `/var/log` и user-mountable файловых систем.
- **Движок.** Подключить локальный кэш фактов в `modules/audit_runner.py`, фиксировать длительность проверок и флаг `timed_out`, расширить схему профиля ограничениями на формат переменных.
- **Документация и UX.** Подготовить примеры интеграции с Ansible/SaltStack и добавить раздел «Remediation» в отчёты при наличии данных в профиле.

### 2.2. Горизонт «Скоро» (квартал)
- **Ролевые и отраслевые профили.** Усилить рабочие станции (GUI, USB), профиль серверов БД (настройки PostgreSQL/MySQL), средства защиты информации (службы, лицензии).
- **Контейнеры и виртуализация.** Создать модуль `containers` с проверками Docker/Podman, внедрить проверки для libvirt/KVM (целостность образов, ограничения доступа к сокетам управления, AppArmor/SELinux).
- **Отчётность и интеграции.** Сгенерировать экспорты SARIF/JUnit и подготовить примеры GitHub Actions/GitLab CI, выполняющие аудит golden-образов.

### 2.3. Горизонт «Дальше» (полугодие)
- **Расширяемость профилей.** Добавить наследуемые allowlist/denylist с приоритетами и генерацию проверок из шаблонов.
- **Аналитика результатов.** Реализовать сравнение отчётов (модуль трендов) и экспорт статусов в Prometheus или Elastic.
- **Автоматическое исправление.** Связать результаты аудита с Ansible-плейбуками и разработать CLI `generate-remediation` для формирования чек-листа по найденным `FAIL`.

## 3. Шаги контроля качества
- Запуск `pytest` и репрезентативных команд `secaudit audit` для подтверждения поведения и фиксации примеров выходных данных.
- Валидация профилей через `secaudit validate` перед публикацией, корректировка YAML при нарушениях схемы.
- Документирование изменений в README и каталогах `docs/`, поддержание актуальности `profiles/include/vars_*.env`.

Документ пересматривается по мере реализации задач. При добавлении новых проверок или модулей обновляйте соответствующие разделы и ссылки.
